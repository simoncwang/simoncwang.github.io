<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/9804079aca.js" crossorigin="anonymous"></script>
    <script src="../javascript/util.js"></script>
    <script src="../javascript/theme_change.js"></script>
    <link rel = "stylesheet" href = "../style.css">
    <title>Projects</title>
  </head>

  <body>
    <!-- navbar section -->
    <nav id="topnav" class="navbar navbar-expand-lg navbar-light fixed-top">
      <button id="theme-toggle">
        <i id = "theme-icon" class="fa-regular fa-lightbulb"></i>
      </button>
      <div class="container">
        <a class="navbar-brand" href="../index.html">
          <i class="fa-solid fa-cow d-inline-block"></i>
          Simon Wang
      </a>
        <!-- <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button> -->
          <div class="navbar-nav">
            <a class="nav-item nav-link" href="../index.html">Home</a>
            <a class="nav-item nav-link active" href="./defaultproject.html">Projects</a>
            <a class="nav-item nav-link" href="../courses.html">Coursework</a>
            <a class="nav-item nav-link" href="https://scw-blog.vercel.app/" target="_blank">Blog</a>
          </div>
      </div>
      
    </nav>

    <div class="project-page" data-theme-target>
        <!-- sidebar section -->
        <div id="mySidenav" class="sidenav" data-theme-target >
          <div class="collapse">
              <a href="javascript:void(0)" onclick="closeNav()"> &times;</a>
          </div>
      
          <div class="container-fluid" style="text-align:center">
              <!-- Sidebar Title -->
              <hr>
  
              <div id="header1" class="section-header" onclick="toggleSection('section1','header1')">
                <div class="section-button">School Projects</div>
                <i class="fa-solid fa-angle-down"></i>
              </div>
  
              <div id="section1" class="section-content">
                  <a class="nav-item nav-link" href="./defaultproject.html">MMO - MLLM Benchmarking</a>
                  <a class="nav-item nav-link" href="./disneybrdf.html">Disney BRDF & Monte Carlo Rendering in PyTorch</a>
                  <a class="nav-item nav-link" href="./magicalpet.html">MagicalPet - A Desktop AI Assistant</a>
                  <a class="nav-item nav-link" href="./videogen.html">Consistent Video Generation</a>
                  <a class="nav-item nav-link" href="./vrclass.html">XR Education</a>
                  <a class="nav-item nav-link" href="./emd.html">Accessibility of Touch Screens for Elderly</a>
              </div>
              
              <div id="header2" class="section-header" onclick="toggleSection('section2','header2')">
                <button class="section-button">Personal Projects</button>
                <i class="fa-solid fa-angle-up"></i>
              </div>

              <div id="section2" class="section-content show-section">
                <a class="nav-item nav-link active" href="./personalrag.html">RAG Quiz</a>
                <a class="nav-item nav-link" href="./artadvisor.html">AI Art Advisor</a>
              </div>
              
          </div>
        </div>
    
        <div id="expandBtn" class="expand">
        <a href="javascript:void(0)" onclick="openNav()"> &#9776;</a>
        </div>
    
        <!-- main content -->
        <div class="container"> 
        <div id = "myContent" class="content">
            <br>
            <h1 style="text-align: center;">Personal RAG Quiz System</h1>
            <h5 style="text-align: center; font-weight:lighter;">Using retrieval augmented generation to help you learn what you want to learn!</h5>
            
            <div class="links">
            <div>
                <i class="fa-brands fa-github-alt"></i> <a href="https://github.com/simoncwang/RAGQuiz" target="_blank">GitHub</a>
            </div>
            <!-- <div>
                <i class="fa-solid fa-laptop-code"></i> <a href="https://huggingface.co/spaces/simoncwang/AIArtAdvisor" target="_blank">Demo</a>
            </div> -->
            <div>
                <i class="fa-solid fa-book"></i> <a>Resources</a>
            </div>
            
            </div>
            
            <br>
            <img src="../images/learning.webp" class="blog-thumbnail rounded mx-auto d-block" style="width:50%">
            <center class="image-caption">AI generated using DALL-E</center>

            <hr>

            <h3>Introduction</h3>
            <p>
            You've most likely used LLM platforms like ChatGPT or Claude to answer your burning questions about various topics, but how do you know where the model is getting its answers from? How can you be sure the sources are reliable, or relevant to your specific situation?
            </p>

            <p>
            <b>Retrieval augmented generation (RAG)</b> is the answer! RAG essentially allows the model to use documents or resources you provide directly as a source to answer your questions! Want to understand the main ideas behind a long paper you're reading? Just upload the pdf and have the AI read through it for you! Want to find the specific instruction you're looking for in a dense text manual for a complicated tool? RAG can pinpoint it for you and even tell you the exact page it's on!
            </p>
            
            <h3>What is this tool?</h3>
            <p>
            As a simple demonstration of just how capable RAG is, and how simple it can be to apply, I created a RAG-powered custom quiz app!
            </p>

            <p>
            This gradio demo is powered by <b>OpenAI's gpt-4o</b> model behind the scenes, and allows you to upload any number of documents you wish. It uses the OpenAI API assistants feature with file search capability (<a href="https://platform.openai.com/docs/assistants/tools/file-search" target="_blank">Official API Docs</a>). On the right hand side, when you click generate, the system will generate a quiz question to help test your knowledge about a random document selected from your custom library!
            </p>

            <p>
            In the URL section, I have also implemented the capability to perform RAG on any website with text content! Simply paste in the URL of a website, and the system will use web scraping with the <b>Selenium Python library</b> to get any relevant text from the page to use for retrieval!
            </p>

            <p>
              Finally, the generated quiz question is displayed in the UI along with interactive elements for the user to choose their answer, as well as submit for "grading". In the backend, the model is also asked to provide the correct choice, so this information is used to provide feedback and help the user learn!
            </p>

            <h3>Structured Outputs</h3>
            <p>
            To ensure consistent response formats from gpt-4o, I employed <a href="https://platform.openai.com/docs/guides/structured-outputs" target="_blank">OpenAI's Structured Outputs</a> feature. This ensures that the model adheres to a user-specified JSON schema, and is perfect for applications such as this in which I rely on the model responses to populate my UI!
            </p>

            <p>
              By definining classes in Python that inherit the Pydantic BaseModel class, we can customize the response format in our model completion call! For example, for my RAG quiz I defined the following schema:
            </p>

            <pre>
              class QuizSchema(BaseModel):
                question: str
                choice1: str
                choice2: str
                choice3: str
                choice4: str
                correct_choice: int
            </pre>
            
            <h4>Limitations...</h4>

            <p>
              While the structured outputs feature works very well in guaranteeing an expected format, I faced some unexpected limitations in implementing them in my workflow.
            </p>

            <p>
              For some reason, it seems that structured outputs are incompatible with various <a href="https://platform.openai.com/docs/assistants/overview" target="_blank">OpenAI Assistants</a> features. Assistants is essentially OpenAI's "agentic" AI solution, giving models access to a variety of tools as well as persistent threads to manage multi-turn conversations. As mentioned before, for this application I used the file search tool to give gpt-4o access to a vector store of user-provided data. However, it appears that <b>structured outputs is incompatible with file search</b> (and other Assistants tools), an experience shared by others as seen in the following <a href="https://community.openai.com/t/structured-outputs-dont-currently-work-with-file-search-tool-in-assistants-api/900538" target="_blank">OpenAI community discussion.</a>
            </p>

            <h4>My (temporary) workaround!</h4>
            <p>
              In order to mitigate this issue, I first make a basic call to gpt-4o without using a custom schema for the format, asking it with some in-context examples to provide a response in a JSOn format using the file search tool. Then, I pipe that response back into another API call, this time with structured outputs enabled, to essentially parse the first answer into my expected format. This allows me to get the same effect, albeit with twice the amount of API calls (and dollars spent...).
            </p>

            <p>
              For reference, here are the prompts I used to first get a quiz format response from the model, as well as the second API call to get the structured output:
            </p>
            
            <p>
              <b>Prompts for getting "raw" output</b>
            </p>
            
            <pre>
              json_prompt = """
                Please provide your question and correct answer using the following JSON format:
                {
                    "question": "question description"
                    "choice1": "answer choice description"
                    "choice2": "answer choice description"
                    "choice3": "answer choice description"
                    "choice4": "answer choice description"
                    "correct choice": "<Single Number>"
                }
                """
              
              final_prompt = "Give me one multiple choice question to test my knowledge of the following content.
                 Please provide your final answer in the following JSON format: " + json_prompt
    
            </pre>

            <p>
              <b>Getting the final structured output</b>
            </p>

            <pre>
              completion = self.client.beta.chat.completions.parse(
                  model="gpt-4o",
                  messages=messages,
                  response_format=QuizSchema,
              )
            </pre>

            <h3>The Demo</h3>
            <p>
            Below is a screenshot of the main UI of the app, showing the features described earlier. Feel free to go to my <a href="https://github.com/simoncwang/RAGQuiz" target="_blank">GitHub</a> to download and test out the app for yourself! Note, you will have to provide your own OpenAI API key! NOTE: A public demo hosted on Huggingface Spaces is in the works as well!
            </p>

            <img src="../images/quizapp.png" style="width:100%">

        </div>
        </div>
    </div>

    
<!-- footer section -->
<div class="footer">
    <p>
      &copy; Simon Wang, 2024.
    </p>
    
    <p>
        <a href="https://getbootstrap.com/" target="_blank">
            <img src="../images/bootstrap-logo-black.svg" width="35" height="30" alt="">
          </a>
      &nbsp;
      Created with Bootstrap. &nbsp;
    
      P.s. thanks to the amazing <a href="https://emilywudesign.myportfolio.com/" target="_blank">Emily Wu</a> for helping with the graphic design!
    </p>
  </div>

</body>
</html>
